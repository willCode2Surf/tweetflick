define=function(){if(typeof wink=="undefined")wink={};var b=arguments,a=b.length;return(a==1?b[0]:a==2?b[1]:b[2])(wink)};define.amd={vendor:"winktoolkit.org"};define(function(){if(typeof wink=="undefined")wink={};return wink});
define(["../../_kernel/js/kernel"],function(b){b.version="1.5.0";b.api={};b.mm={};b.net={};b.plugins={};b.ui={form:{},layout:{},xy:{},xyz:{}};b.ux={};var a=Array.prototype.slice,c=window;b.byId=function(e){return b.isString(e)?document.getElementById(e):e};b.query=function(e,f){return a.call((f||document).querySelectorAll(e))};var d="en_EN";b.setLocale=function(e){d=e};b.translate=function(e,f){var h=e,i=window.i18n||{};if(b.isSet(f)&&b.isSet(f.i18n))i=f.i18n;var j=i[d];if(b.isUndefined(j))j=i;i=
j[e];b.isUndefined(i)||(h=i);return h};b.isUndefined=function(e){return e===undefined};b.isNull=function(e){return e===null};b.isSet=function(e){return!b.isUndefined(e)&&!b.isNull(e)};b.isCallback=function(e){return!!(e&&e.method)};b.isString=function(e){return typeof e=="string"||e instanceof String};b.isInteger=function(e){return parseInt(e)===e};b.isNumber=function(e){return typeof e=="number"||e instanceof Number};b.isArray=function(e){return typeof e=="array"||e instanceof Array};b.isBoolean=
function(e){return typeof e=="boolean"||e instanceof Boolean};b.isFunction=function(e){return Object.prototype.toString.call(e)==="[object Function]"};b.trim=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};b.bind=function(e,f){var h=a.call(arguments,2);return function(){var i=h.concat(a.call(arguments,0));return e.apply(f,i)}};b.call=function(e,f){var h=c,i=e.method,j=[];if(b.isSet(e.context))h=e.context;if(arguments.length==2)j=[f];if(b.isSet(e.arguments)){var o=e.arguments;b.isArray(o)||
(o=[e.arguments]);j=j.concat(o)}return h[i].apply(h,j)};b.connect=function(e,f,h){if(!b.isSet(h.context))h.context=c;var i=e[f];if(b.isNull(i)||b.isUndefined(i.cbs)){var j=function(){var k=arguments.callee.target,n=[],l,m=arguments.length;for(l=0;l<m;l++){var p=arguments[l];n=b.isArray(p)?n.concat([p]):n.concat(p)}k&&k.apply(e,n);k=e[f].cbs;for(var q in k)b.isArray(k[q].arguments)?b.call({context:k[q].context,method:k[q].method,arguments:n.concat(k[q].arguments)}):b.call({context:k[q].context,method:k[q].method,
arguments:n.concat([k[q].arguments])})};j.target=i;j.cbs=[];i=e[f]=j}for(var o in i.cbs)if(i.cbs[o].context==h.context&&i.cbs[o].method==h.method)return;i.cbs.push(h)};b.disconnect=function(e,f,h){if(!b.isSet(h.context))h.context=c;e=e[f];if(!b.isUndefined(e.cbs))for(var i in e.cbs)e.cbs[i].context==h.context&&e.cbs[i].method==h.method&&delete e.cbs[i]};b.setTimeout=function(e,f,h){var i=a.call(arguments,3);return setTimeout(function(){e[f].apply(e,i)},h)};b.setInterval=function(e,f,h){var i=a.call(arguments,
3);return setInterval(function(){e[f].apply(e,i)},h)};var g=100;b.getUId=function(){return g+=1};if(b.isUndefined(c._))_=b.bind(b.translate,b);if(b.isUndefined(c.$$))$$=b.bind(b.query,b);if(b.isUndefined(c.$))$=b.bind(b.byId,b);return b});
define(["../../../_base/_base/js/base"],function(b){var a=HTMLElement.prototype,c=b.isUndefined,d=function(o){var k=0,n=this;if(b.isSet(o))for(;n&&n!=o;){k+=n.offsetTop;n=n.offsetParent}else for(;n;){k+=n.offsetTop;n=n.offsetParent}return k},g=function(o){var k=0,n=this;if(b.isSet(o))for(;n&&n!=o;){k+=n.offsetLeft;n=n.offsetParent}else for(;n;){k+=n.offsetLeft;n=n.offsetParent}return k},e=function(o,k,n){b.fx.applyTranslate(this,o,k,n)},f=function(o,k){b.fx.applyScale(this,o,k)},h=function(o){b.fx.applyRotate(this,
o)},i=function(o,k,n){b.ux.gesture.listenTo(this,o,k,n)},j=function(o,k){b.ux.gesture.unlistenTo(this,o,k)};a.winkGetTopPosition=d;a.winkGetLeftPosition=g;a.winkTranslate=e;a.winkScale=f;a.winkRotate=h;a.winkListenToGesture=i;a.winkUnlistenToGesture=j;if(c(a.getTopPosition))a.getTopPosition=d;if(c(a.getLeftPosition))a.getLeftPosition=g;if(c(a.rotate))a.rotate=h;if(c(a.scale))a.scale=f;if(c(a.translate))a.translate=e;if(c(a.listenToGesture))a.listenToGesture=i;if(c(a.unlistenToGesture))a.unlistenToGesture=
j;return b});define(["../../../_base/_base/js/base"],function(b){b.error={logLevel:0,log:function(a){if(this.logLevel==1)typeof console!="undefined"?console.log(a):alert(a)}};b.log=b.bind(b.error.log,b.error);return b.error});
define(["../../../_base/_base/js/base"],function(b){var a=window.JSON;b.json={parse:function(c){if(b.isSet(a)&&b.isSet(a.parse))return a.parse(c);else{var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;c=String(c);d.lastIndex=0;if(d.test(c))c=c.replace(d,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))var g=eval("("+c+")");return g}},concat:function(c,d){for(var g in d)c[g]=d[g];return c}};b.parseJSON=b.bind(b.json.parse,b.json);b.mixin=b.bind(b.json.concat,b.json);return b.json});
define(["../../../_base/_base/js/base","../../error/js/error"],function(b){var a=[],c=function(e,f){if(b.isCallback(f)){var h=[e.toLowerCase(),f];a.push(h)}},d=function(e,f){var h=e.toLowerCase(),i,j=a.length;for(i=0;i<j;i++){var o=a[i];if(o[0]==h&&o[1].method==f.method&&o[1].context==f.context){a.splice(i,1);break}}},g=function(e,f){var h=e.toLowerCase(),i,j=a.length;for(i=0;i<j;i++){var o=a[i];o&&o[0]==h&&b.isSet(o[1])&&b.call(o[1],f)}};b.topics={subscribe:c,unsubscribe:d,publish:g,_getTopics:function(){return a}};
b.publish=g;b.subscribe=c;b.unsubscribe=d;return b.topics});
define(["../../../_base/_base/js/base"],function(b){var a,c,d,g,e,f,h,i,j,o,k,n,l,m,p,q,s,r,t,u,x,A,D;a=c=d=g=e=f=h=i=x=A=D=false;j=o=k=n=l=m=p=q=s=0;var B=b.isSet;c=function(v,C){return RegExp(v).test(C)};var w=function(v,C,z){var E={v:0,r:0,u:0};v=RegExp(C).exec(v);if(B(v)&&v.length>1){v=v[2];C=RegExp("[^\\"+z+"0-9]").exec(v);if(B(C))v=v.slice(0,C.index);z=v.split(z);if(z.length>0)E.v=z[0];if(z.length>1)E.r=z[1];if(z.length>2)E.u=z[2];if(z.length>3)E.u+="."+z[3]}return E};a=navigator||{};r=a.userAgent;
t=a.platform;u=a.appVersion;a=c(" AppleWebKit/",r);A=c(/bada/gi,r);D=c(/Opera/gi,r);if(B(t)){if(c(/iphone/i,t))d=true;if(c(/ipod/i,t))g=true;if(c(/ipad/i,t))e=true;if(c(/blackberry/i,t))x=true}if(B(u)){if(c(/android/i,u))f=true;if(c(/safari/i,u)){h=true;t=w(u,"( Version/)([^ ]+)",".");n=t.v;l=t.r;m=t.u}}if(!h&&!a)i=c(/mozilla/i,r);c=d||g||f||x||A||c(" Mobile/",r);if(a){t=w(r,"( AppleWebKit/)([^ ]+)",".");j=t.v;o=t.r;k=t.u}if(c&&B(u)){p=f?["( Android )([^ ]+)","."]:["( OS )([^ ]+)","_"];if(x)p=["( BlackBerry )([^ ]+)",
"."];w=w(u,p[0],p[1]);p=w.v;q=w.r;s=w.u}b.ua={isWebkit:a,isMobile:c,isIPhone:d,isIPod:g,isIPad:e,isIOS:d||g||e,isAndroid:f,isBlackBerry:x,isBada:A,isOpera:D,isSafari:h,isMozilla:i,webkitVersion:j,webkitMinorVersion:o,webkitUpdateVersion:k,browserVersion:n,browserMinorVersion:l,browserUpdateVersion:m,osVersion:p,osMinorVersion:q,osUpdateVersion:s};return b.ua});
define(["../../../_base/_base/js/base"],function(b){function a(f){if(d(g[f]))g[f]=g[f]();return g[f]}function c(f,h,i){if(typeof g[f]=="undefined"){var j=h;if(i&&d(h))j=h();g[f]=j}}function d(f){return typeof f=="function"}var g={},e={};b.has=a;b.has.prefixes=["-webkit-","-moz-","-o-","-ms-","-khtml-"];b.has.prefix=null;b.has.inquire=c;b.has.inquireMap=function(f,h){if(!(!f||f.length==0))for(var i in f)c(i,f[i],h)};b.has.setProp=function(f,h){e[f]=h};b.has.deferProp=function(f,h){e[f]=d(h)?h:function(){a(h)}};
b.has.prop=function(f){var h=e[f];if(d(h)){h();h=e[f];if(d(h))h=f}return h||f};return b.has});define(["../../../_base/_base/js/base","./feat"],function(b){b=b.has;var a=b.inquire,c=window;a("json-parse",function(){var d;d=false;if(c.JSON&&typeof JSON.parse=="function"){d=JSON.parse('{"w":1}');d=!!(d&&d.w)}return d});return b});
define(["../../../_base/_base/js/base","./feat"],function(b){function a(m){var p=false;if(typeof o[m]==n){e(m,m);p=true}else{var q=d.prefix;q=q!=null?[q]:k;var s,r=q.length;for(s=0;s<r;s++){var t,u=q[s]+m;t=u;var x=/(-)([a-z])/;for(u=u.match(x);u!=null;){t=t.replace(x,RegExp.$2.toUpperCase());u=t.match(x)}t=t;if(typeof o[t]==n){d.prefix=q[s];e(m,t);p=true;break}}}return p}function c(m){return function(){a(m)}}var d=b.has,g=d.inquireMap,e=d.setProp,f=d.deferProp,h=window,i=h.document,j=i.createElement("div"),
o=j.style,k=d.prefixes,n="string",l={a:"transform-property",b:"transition-property",c:"transition-duration",d:"transition-delay",e:"transition-timing-function",f:"border-radius",g:"text-shadow",h:"box-shadow",i:"gradient",j:"perspective",k:"transform-origin",l:"transform-style",m:"transform",n:"css-transition",o:"css-perspective",p:"css-transform",q:"perspective-origin",r:"backface-visibility",s:"tap-highlight-color",t:"user-select",bg:"background-image"};f(l.a,l.p);f(l.m,l.p);f(l.b,l.n);f(l.c,l.n);
f(l.d,l.n);f(l.e,l.n);f(l.f,"css-border-radius");f(l.g,"css-text-shadow");f(l.h,"css-box-shadow");f(l.i,"css-gradient");f(l.j,l.o);f(l.k,l.o);f(l.l,l.o);f(l.q,l.o);f(l.r,c(l.r));f(l.s,c(l.s));f(l.t,c(l.t));g({"css-transform":function(){var m=a(l.m),p=d.prefix,q=l.m;if(p!=null)q=p+q;e(l.a,d.prop(l.m));e(l.m,q);return m},"css-transition":function(){var m=true;return m=(m=(m=(m=m&&a(l.b))&&a(l.c))&&a(l.d))&&a(l.e)},"css-translate3d":function(){return d("css-matrix")},"css-border-radius":function(){return a(l.f)},
"css-text-shadow":function(){return a(l.g)},"css-box-shadow":function(){return a(l.h)},"css-gradient":function(){var m=l.i,p=l.bg,q=d.prefix;q=q!=null?["",q]:[""].concat(k);var s,r=q.length;for(s=0;s<r;s++){var t=q[s]+m;o.cssText=p+":"+(t+"(linear,left top,right bottom,from(#9f9),to(white));");if(o[p]&&o[p].indexOf(m)!=-1){e(m,t);return true}}return false},"css-perspective":function(){var m=a(l.j)&&a(l.k)&&a(l.l)&&a(l.q);m=m&&a(l.k+"-x")&&a(l.k+"-y")&&a(l.k+"-z");if(!m)return false;var p=d.prefix||
"";m=i.createElement("style");m.textContent="@media ("+p+"transform-3d){#wink_has{height:2px}}";i.getElementsByTagName("head")[0].appendChild(m);j.id="wink_has";i.documentElement.appendChild(j);p=j.offsetHeight===2;m.parentNode.removeChild(m);j.parentNode.removeChild(j);return p},"css-matrix":function(){var m=h.WebKitCSSMatrix;if(typeof m=="undefined")return false;var p=new m("matrix(1,0,0,1,6,7)"),q=p.m41==6&&p.m42==7&&p.m41==p.e&&p.m42==p.f;if(q){m=new m("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,6,7,8,1)");
q=q&&p.m41==m.m41&&p.m42==m.m42&&m.m43==8}return q},"css-matrix-stack-inversed":function(){var m=b.ua;if(!d("css-matrix")||!m)return false;return(m.isIOS?parseInt(""+m.osVersion+m.osMinorVersion+m.osUpdateVersion):500)<421},"css-position-fixed":function(){var m=b.ua;if(m.isAndroid&&m.osVersion==2&&m.osMinorVersion==1||m.isBada)return false;m=document.body;if(document.createElement&&m&&m.appendChild&&m.removeChild){if(!j.getBoundingClientRect)return null;j.innerHTML="x";j.style.cssText="position:fixed;top:100px;";
m.appendChild(j);var p=m.style.height,q=m.scrollTop;m.style.height="3000px";m.scrollTop=500;var s=j.getBoundingClientRect().top;m.style.height=p;p=s===100;m.removeChild(j);m.scrollTop=q;return p}return false}});return d});
define(["../../../_base/_base/js/base","./feat"],function(b){function a(h){return"on"+f[h]in e}var c=b.has;b=c.inquireMap;var d=c.setProp,g=c.deferProp,e=window.document.documentElement,f={ts:"touchstart",tm:"touchmove",te:"touchend",gs:"gesturestart",gc:"gesturechange",ge:"gestureend",tre:"transitionend"};g(f.ts,f.ts);g(f.tm,f.tm);g(f.te,f.te);g(f.tre,f.tre);b({touchstart:function(){var h=a("ts");d(f.ts,h?f.ts:"mousedown");return h},touchmove:function(){var h=a("tm");d(f.tm,h?f.tm:"mousemove");return h},
touchend:function(){var h=a("te");d(f.te,h?f.te:"mouseup");return h},touch:function(){return c(f.ts)&&c(f.tm)&&c(f.te)},gesturestart:function(){return a("gs")},gesturechange:function(){return a("gc")},gestureend:function(){return a("ge")},gesture:function(){return c(f.gs)&&c(f.gc)&&c(f.ge)},transitionend:function(){if(c("css-transition")){var h=c.prefix,i=f.tre;if(h=="-webkit-")i="webkitTransitionEnd";else if(h=="-o-")i="oTransitionEnd";d(f.tre,i);return true}return false}});return c});
define(["../../../_base/_base/js/base","./feat"],function(b){return b.has});
define(["../../../_base/_base/js/base","../../../_base/_feat/js/feat_css"],function(b){var a=b.isSet,c=b.has.prop,d={u:undefined},g=function(k,n){var l=k.className;if((" "+l+" ").indexOf(" "+n+" ")<0)k.className=l+(l?" ":"")+n},e=function(k,n){var l=b.trim((" "+k.className+" ").replace(" "+n+" "," "));if(k.className!=l)k.className=l},f=function(k,n){var l,m=k.style;for(l in n){var p=c(l);m[p]=n[l]}},h=function(k,n,l,m,p){var q=n;if(n.indexOf(",")==-1)q=c(n);else{n=n.split(",");var s=n.length;for(q=
0;q<s;q++)n[q]=c(b.trim(n[q]));q=n.join(",")}f(k,{"transition-property":q,"transition-duration":l,"transition-delay":m,"transition-timing-function":p})},i=function(k){return window.getComputedStyle(k)[c("transform-property")]},j=function(k,n){f(k,{"transform-property":n})},o=function(k,n,l,m,p,q,s){var r=k._cssT||{};r=k._cssT={t:a(n)||a(l)?{tx:n,ty:l}:r.t,s:a(m)||a(p)?{sx:m,sy:p}:r.s,r:a(q)?{a:q}:r.r};m=r.t&&(a(r.t.tx)||a(r.t.ty));l=r.s&&(a(r.s.sx)||a(r.s.sy));n=r.r&&a(r.r.a);if(!b.has("css-translate3d")||
b.ua.isAndroid&&(l||n))s=true;if(m){p=r.t.ty;s=s;m="";m=r.t.tx;a(m)||(m=0);p=p;a(p)||(p=0);q="0";var t=false;t=(t=t||b.isString(m)&&m.indexOf("%",0)!=-1)||b.isString(p)&&p.indexOf("%",0)!=-1;if(!t){m+="px";p+="px";q+="px"}s=m=s?"translate("+m+", "+p+")":"translate3d("+m+", "+p+", "+q+")"}else s="";s=s;if(l){l=r.s.sy;m="";m=r.s.sx;a(m)||(m=1);l=l;a(l)||(l=1);l=m="scale("+m+", "+l+")"}else l="";l=l;if(n){n="";r=r.r.a;a(r)||(r=0);r=n="rotate("+r+"deg)"}else r="";r=b.trim(s+" "+l+" "+r);j(k,r)};b.fx=
{addClass:g,removeClass:e,apply:f,applyTransition:h,applyTransformTransition:function(k,n,l,m){h(k,"transform",n,l,m)},onTransitionEnd:function(k,n,l){var m=c("transitionend"),p=function(q){l!==true&&k.removeEventListener(m,p,false);n(q)};k.addEventListener(m,p,false);return p},getTransformPosition:function(k){var n={x:null,y:null};k=i(k);if(b.has("css-matrix")){k=new WebKitCSSMatrix(k);n.x=k.m41;n.y=k.m42}else{var l=RegExp(/matrix/i);if(l.test(k)){l=RegExp("[, ()]+","g");k=k.split(l);if(k.length>
6&&k[0]=="matrix"){n.x=parseInt(k[5]);n.y=parseInt(k[6])}}}return n},applyTranslate:function(k,n,l,m){o(k,n,l,d.u,d.u,d.u,m)},applyScale:function(k,n,l){o(k,d.u,d.u,n,l,d.u,d.u)},applyRotate:function(k,n){o(k,d.u,d.u,d.u,d.u,n,d.u)},getTransform:i,setTransform:j};b.addClass=g;b.removeClass=e;return b.fx});define(["../../../_base/_base/js/base"],function(b){b.math={round:function(a,c){b.isSet(c)||(c=0);var d=Math.pow(10,c);return Math.round(a*d)/d}};return b.math});
define(["../../../_base/_base/js/base","../../../_base/error/js/error","../../../_base/json/js/json"],function(b){var a=b.isSet;b.ux.Event=function(c){this.uId=b.getUId();b.mixin(this,c);this._validateProperties()};b.ux.Event.prototype={preventDefault:function(){this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},dispatch:function(c,d){var g=this.srcEvent,e=g.type;if(a(d))e=d;e=e;var f="HTMLEvents";if(/blur|focus|resize|scroll/i.test(e))f="UIEvent";else if(/click|mouse(down|move|up)/i.test(e))f=
"MouseEvent";else if(/touch(start|move|end|cancel)/i.test(e))f="TouchEvent";var h=document.createEvent(f),i=g.changedTouches;if(f=="HTMLEvents")h.initEvent(e,g.bubbles,g.cancelable);else if(f=="UIEvent")h.initUIEvent(e,g.bubbles,g.cancelable,window,g.detail);else if(f=="MouseEvent"){f=g.screenX;var j=g.screenY,o=g.clientX,k=g.clientY;if(g.initTouchEvent&&i&&i.length>0){i=i[0];f=i.screenX;j=i.screenY;o=i.clientX;k=i.clientY}h.initMouseEvent(e,g.bubbles,g.cancelable,document.defaultView,g.detail,f,
j,o,k,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.button,g.relatedTarget)}else f=="TouchEvent"&&h.initTouchEvent(e,g.bubbles,g.cancelable,window,g.detail,g.screenX,g.screenY,g.clientX,g.clientY,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.touches,g.targetTouches,i,g.scale,g.rotation);c.dispatchEvent(h)},_validateProperties:function(){return true}};return b.ux.Event});
define(["../../../_base/_base/js/base","../../../_base/error/js/error","../../../_base/_feat/js/feat_event","../../event/js/event"],function(b){var a=[],c=b.has.prop,d={start:c("touchstart"),move:c("touchmove"),end:c("touchend"),gesturestart:c("gesturestart"),gesturechange:c("gesturechange"),gestureend:c("gestureend")},g={};for(var e in d)g[d[e]]=e;var f=function(i){var j={};j.x=i.pageX;j.y=i.pageY;j.target=i.target;return j},h=function(i){var j,o=a.length;for(j=0;j<o;j++)if(a[j].domNode==i)return j;
return null};b.ux.touch={addListener:function(i,j,o,k){if(b.isUndefined(d[j])){b.log("[touch] Cannot add listener for unknown eventType: "+j);return false}b.isSet(k)||(k={});if(k===true)k={preventDefault:true};k={preventDefault:k.preventDefault===true?true:false,tracking:k.tracking===false?false:true,captureFlow:k.captureFlow===true?true:false};var n=null,l=h(i);if(l==null){n=new b.ux.touch.Element({domNode:i,tracking:k.tracking});a.push(n)}else n=a[l];if(!n.isListening(j)){if(n.eventHandler==null)n.eventHandler=
function(m){var p=n,q=g[m.type],s={};s.type=q;s.srcEvent=m;s.timestamp=m.timeStamp;s.multitouch=false;if(!s.timestamp)s.timestamp=(new Date).getTime();if(b.has("touch"))if(q=="gesturestart"||q=="gesturechange"||q=="gestureend"){s.target=m.target;s.x=0;s.y=0}else{var r=null;if(q=="end"){if(m.changedTouches&&m.changedTouches.length>0)r=m.changedTouches[0]}else if(m.targetTouches&&m.targetTouches.length>0)r=m.targetTouches[0];else if(m.changedTouches&&m.changedTouches.length>0)r=m.changedTouches[0];
if(r!=null){r=f(r);s.x=r.x;s.y=r.y;s.target=r.target;if(m.touches&&m.touches.length>1)s.multitouch=true}}else{r=f(m);s.x=r.x;s.y=r.y;s.target=r.target}m=new b.ux.Event(s);if(!p.isListening("start")||p.tracking==false)p.tracked=true;else if(q=="start")p.tracked=true;if(p.tracked==true){if(q=="end")p.tracked=false;p.notifyEvent(m)}};n.eventCaptures[j]=k.captureFlow;n.domNode.addEventListener(d[j],n.eventHandler,n.eventCaptures[j])}n.addEventCallback(j,o,k.preventDefault)},removeListener:function(i,
j,o){i=h(i);if(i!=null){i=a[i];i.removeEventCallback(j,o);i.isListening(j)||i.domNode.removeEventListener(d[j],i.eventHandler,i.eventCaptures[j])}},getTouchProperties:f};b.ux.touch.Element=function(i){this.uId=b.getUId();this.tracked=false;this.eventHandler=null;this.eventCaptures={};this._els={};b.mixin(this,i);this._validateProperties()};b.ux.touch.Element.prototype={addEventCallback:function(i,j,o){if(!b.isCallback(j))return false;var k=this._els[i];if(k){i=k.callbacks;var n=i.length;for(o=0;o<
n;o++){var l=i[o];if(j.context==l.context&&j.method==l.method)return false}}else{k={preventDefault:o,callbacks:[]};this._els[i]=k}k.callbacks.push(j);return true},removeEventCallback:function(i,j){if(!b.isCallback(j))return false;var o=this._els[i];if(!o)return false;var k=o.callbacks,n,l=k.length;for(n=0;n<l;n++){var m=k[n];if(j.context==m.context&&j.method==m.method){o.callbacks.splice(n,1);break}}return true},isListening:function(i){if((i=this._els[i])&&i.callbacks.length>0)return true;return false},
notifyEvent:function(i){var j=this._els[i.type];if(j){j.preventDefault==true&&i.preventDefault();j=j.callbacks;for(var o=0;o<j.length;o++)b.call(j[o],i)}},_validateProperties:function(){return true}};return b.ux.touch});
define(["../../../_base/_base/js/base","../../../_base/error/js/error"],function(b){var a=b.isSet,c=b.isArray;b.net.Xhr=function(d){this.uId=b.getUId();this.request={xhrObject:null,params:d};this._create()};b.net.Xhr.prototype={sendData:function(d,g,e,f,h,i){var j=this.request,o=j.xhrObject,k=encodeURIComponent;e=e.toUpperCase();if(!(a(g)&&!c(g))){if(o){var n=null;if(a(g)){var l,m=g.length;for(l=0;l<m;l++){var p=g[l],q=p.name;p=p.value;if(e=="GET")d+=l==0&&d.indexOf("?")==-1?"?"+k(q)+"="+k(p):"&"+
k(q)+"="+k(p);else if(l==0)n=k(q)+"="+k(p);else n+="&"+k(q)+"="+k(p)}}try{o.open(e,d,true);o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");if(a(i))if(c(i)){m=i.length;for(l=0;l<m;l++){var s=i[l];o.setRequestHeader(s.name,s.value)}}o.send(n)}catch(r){return false}o.onreadystatechange=function(){if(o.readyState==4){var t=o.status;if(t>=200&&t<400||t==0)a(f)&&b.call(f,j);else a(h)&&b.call(h,j)}}}else return false;return true}},_create:function(){var d=window.XMLHttpRequest;
if(d){var g;try{g=new d}catch(e){g=false}this.request.xhrObject=g}}};b.Xhr=b.net.Xhr;return b.Xhr});
define(["../../../../_base/_base/js/base","../../../../fx/_xy/js/2dfx"],function(b){var a=b.fx.apply,c=null,d=null,g=false;b.ui.xy.layer={visible:false,color:"#000",opacity:0.3,zIndex:998,show:function(){g||this._initDom();c.onclick=function(){var e=b.ui.xy.layer.onclick;b.isSet(e)&&e()};if(!this.visible){a(d,{height:document.body.scrollHeight+"px"});a(c,{display:"block"});this.visible=true}},hide:function(){if(g&&this.visible){a(c,{display:"none"});this.visible=false}},refresh:function(){g&&this.visible&&
a(d,{height:document.body.scrollHeight+"px"})},update:function(){g||this._initDom();a(c,{"z-index":this.zIndex});a(d,{backgroundColor:this.color,opacity:this.opacity})},_initDom:function(){var e=document;c=e.createElement("div");a(c,{position:"absolute",display:"none",top:0,width:"100%","z-index":this.zIndex,"tap-highlight-color":"rgba(0, 0, 0, 0)"});d=e.createElement("div");a(d,{width:"100%",backgroundColor:this.color,opacity:this.opacity});c.appendChild(d);e.body.appendChild(c);g=true}};b.layer=
b.ui.xy.layer;return b.layer});
define(["../../../_base/_base/js/base","./json"],function(b){var a=b.json,c=[];a.stringify=function(e){var f;if(e)f=b.isSet(window.JSON)&&b.isSet(window.JSON.stringify)?window.JSON.stringify(e):d(e);return f};var d=function(e){var f;if(e&&b.isSet(e.toJSON)){f=e.toJSON();if(b.isString(f))f=g(f)}else if(b.isString(e))f=g(e);else if(b.isNumber(e))f=isFinite(e)?e:"null";else if(b.isNull(e))f="null";else if(b.isBoolean(e))f=e?"true":"false";else if(!b.isUndefined(e)&&typeof e!="function"){if(b.isArray(e))a:{f=
[];for(var h=0;h<c.length;h++)if(c[h]==e){e=void 0;break a}c.push(e);var i;for(h=0;h<e.length;h++){i=d(e[h]);f.push(b.isUndefined(i)?"null":i)}if(f.length==0)e="[]";else{e="";for(h=0;h<f.length;h++)e+=f[h]+",";e=e.slice(0,-1);e="["+e+"]"}c.pop();e=e}else a:{i=[];f=[];for(h=0;h<c.length;h++)if(c[h]==e){e=void 0;break a}c.push(e);for(var j in e)i.push(j);for(h=0;h<i.length;h++){j=d(e[i[h]]);if(!b.isUndefined(j)){j=g(i[h])+":"+j;f.push(j)}}if(f.length==0)str="{}";else{e="";for(h=0;h<f.length;h++)e+=
f[h]+",";e=e.slice(0,-1);str="{"+e+"}"}c.pop();e=str}f=e}return f},g=function(e){e=e.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(f){var h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};h[f]||(h[f]="\\u"+("0000"+(+f.charCodeAt(0)).toString(16)).slice(-4));return h[f]});return e='"'+e+'"'};return a});
define(["../../../_amd/core"],function(b){b.ux.window={height:null,width:null,fullHeight:null,fullWidth:null,screenHeight:screen.height,screenWidth:screen.width,orientation:null,_i:null,_V:"vertical",_H:"horizontal",_init:function(){var a=b.bind(this._updateData,this);"onorientationchange"in window?window.addEventListener("orientationchange",a,true):window.addEventListener("resize",a,true);if(b.ua.isAndroid){scrollTo(0,1,0);this._i=setInterval(a,1E3)}else window.addEventListener("scroll",a,true);
a()},_updateData:function(){var a=window.innerWidth,c=window.innerHeight,d=false;if(this.width+2<a||this.width-2>a||this.height+2<c||this.height-2>c)d=true;this._updateSize();this._updateOrientation();d&&b.publish("/window/events/resize",{height:c,width:a,orientation:this.orientation})},_updateSize:function(){this.height=window.innerHeight;this.width=window.innerWidth;try{this.fullHeight=document.body.scrollHeight;this.fullWidth=document.body.scrollWidth}catch(a){}},_updateOrientation:function(){var a;
a=b.isSet(window.orientation)&&b.ua.isIOS?Math.abs(window.orientation)==90?this._H:this._V:this.width>this.height?this._H:this._V;if(a!=this.orientation){this.orientation=a;b.publish("/window/events/orientationchange",{height:this.height,width:this.width,orientation:this.o})}}};window.addEventListener("DOMContentLoaded",function(){b.ux.window._init()});b.ux.Window=function(){this.getProperties=function(){return{screenWidth:b.ux.window.screenWidth,screenHeight:b.ux.window.screenHeight,width:b.ux.window.width,
height:b.ux.window.height,orientation:b.ux.window.orientation}}};return b.ux.window});
define(["../../../_amd/core"],function(b){b.math.radToDeg=function(a){return a*180/Math.PI};b.math.degToRad=function(a){return a*Math.PI/180};b.math.getAngle=function(a,c){var d=Math.abs(c);if(d>a*2)d=a*2;var g=2*a*a;d=Math.acos(-((Math.pow(d,2)-(Math.pow(a,2)+Math.pow(a,2)))/g));if(isNaN(d))d=0;return d};b.math.getAngleBetweenVectors=function(a,c){var d=b.math.getScalarVector(a,c),g=b.math.getNormVector(a)*b.math.getNormVector(c);d=Math.acos(d/g);if(isNaN(d))d=0;return d};b.math.normalizeVector=
function(a){var c=[0,0,0,1],d=b.math.getNormVector(a);if(d<=0)return c;c[0]=a[0]/d;c[1]=a[1]/d;c[2]=a[2]/d;return c};b.math.getNormVector=function(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return a=Math.sqrt(a)};b.math.getNormalVector=function(a,c){var d=[0,0,0,1];d[0]=a[1]*c[2]-a[2]*c[1];d[1]=a[2]*c[0]-a[0]*c[2];d[2]=a[0]*c[1]-a[1]*c[0];return d};b.math.getScalarVector=function(a,c){var d=0;return d=a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};b.math.getVector=function(a,c){var d=[0,0,0,1];d[0]=c[0]-a[0];d[1]=c[1]-a[1];
d[2]=c[2]-a[2];return d};b.math.multiplyMatrixVector=function(a,c){var d=[0,0,0,1];c[3]||(c[3]=1);d[0]=c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]*a[3];d[1]=c[0]*a[4]+c[1]*a[5]+c[2]*a[6]+c[3]*a[7];d[2]=c[0]*a[8]+c[1]*a[9]+c[2]*a[10]+c[3]*a[11];d[3]=c[0]*a[12]+c[1]*a[13]+c[2]*a[14]+c[3]*a[15];return d};return b.math});
define(["../../../_amd/core"],function(b){b.math.createTransformMatrix=function(a){var c=new b.math.Matrix({});b.isSet(a)&&c.loadCssTransform(a);return c};b.math.Matrix=function(a){this.uId=b.getUId();this._properties=a;this._values=[];this._cssMatrix=null;this._validateProperties()!==false&&this._initProperties()};b.math.Matrix.prototype={scale:function(a,c,d){this._load(this._cssMatrixToValues(this._cssMatrix.scale(a,c,d)))},translate:function(a,c,d){this._load(this._cssMatrixToValues(this._cssMatrix.translate(a,
c,d)))},rotateAxisAngle:function(a,c,d,g){this._load(this._cssMatrixToValues(this._cssMatrix.rotateAxisAngle(a,c,d,g)))},multiply:function(a){a=a.getCssMatrix();var c=this._cssMatrix;if(b.has("css-matrix-stack-inversed")){var d=a;a=c;c=d}this._load(this._cssMatrixToValues(a.multiply(c)))},clone:function(){return new b.math.Matrix({values:this._values})},loadCssTransform:function(a){if(isString(a)){if(a.indexOf("matrix3d")!=-1){a=a.substring(9,a.length-1).split(", ");for(var c=[],d=0;d<a.length;d++)c[d]=
a[d]*1;this._load(c)}}else try{this._load(this._cssMatrixToValues(a))}catch(g){}},getValues:function(){return this._values},getCssMatrix:function(){return this._cssMatrix},_validateProperties:function(){return true},_initProperties:function(){b.isSet(this._properties.values)?this._load(this._properties.values):this._loadIdentity()},_loadIdentity:function(){this._load([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},_load:function(a){if(!b.isSet(a)||a.length!=16)return false;this._values=a;this._cssMatrix=this._valuesToCssMatrix(this._values)},
_valuesToCssMatrix:function(a){var c=new WebKitCSSMatrix;c.m11=a[0];c.m12=a[1];c.m13=a[2];c.m14=a[3];c.m21=a[4];c.m22=a[5];c.m23=a[6];c.m24=a[7];c.m31=a[8];c.m32=a[9];c.m33=a[10];c.m34=a[11];c.m41=a[12];c.m42=a[13];c.m43=a[14];c.m44=a[15];return c},_cssMatrixToValues:function(a){var c=[];c[0]=a.m11;c[1]=a.m12;c[2]=a.m13;c[3]=a.m14;c[4]=a.m21;c[5]=a.m22;c[6]=a.m23;c[7]=a.m24;c[8]=a.m31;c[9]=a.m32;c[10]=a.m33;c[11]=a.m34;c[12]=a.m41;c[13]=a.m42;c[14]=a.m43;c[15]=a.m44;return c}};return b.math});
define(["../../../_amd/core","../../../math/_matrix/js/matrix"],function(b){var a=[];b.fx.set3dTransform=function(g,e,f){if(!c(e))return false;var h;if(f===true)h=b.fx.getTransform(g);f=b.math.createTransformMatrix(h);e=d(e);f.multiply(e);b.fx.setTransform(g,f.getCssMatrix())};b.fx.initComposedTransform=function(g,e){var f;if(e===true)f=b.fx.getTransform(g);f=b.math.createTransformMatrix(f);b.fx.removeComposedTransform(g);a.push({node:g,transforms:[f]})};b.fx.setTransformPart=function(g,e,f){if(!c(f))return false;
if(e<1||e>10)return false;var h,i=a.length;for(h=0;h<i;h++){var j=a[h];if(j.node==g){g=null;if(b.isSet(f))g=d(f);j.transforms[e]=g;break}}};b.fx.applyComposedTransform=function(g,e){var f,h=a.length;for(f=0;f<h;f++){var i=a[f];if(i.node==g){f=i.transforms;h=f[0].clone();var j,o=f.length;for(j=1;j<o;j++){var k=f[j];b.isSet(k)&&h.multiply(k)}if(e===true)i.transforms=[h];b.fx.setTransform(g,h.getCssMatrix());break}}};b.fx.storeComposedTransform=function(g){b.fx.applyComposedTransform(g,true)};b.fx.removeComposedTransform=
function(g){var e,f=a.length;for(e=0;e<f;e++)if(a[e].node==g){a.splice(e,1);break}};var c=function(g){var e=true,f=b.isSet;if(f(g)){var h=["translate","scale","rotate"];if((e=(e=(e=(e=(e=e&&f(g.type))&&h.indexOf(g.type)!=-1)&&f(g.x))&&f(g.y))&&f(g.z))&&g.type=="rotate")e=e&&f(g.angle)}return e},d=function(g){var e=b.math.createTransformMatrix();switch(g.type){case "translate":e.translate(g.x,g.y,g.z);break;case "scale":e.scale(g.x,g.y,g.z);break;case "rotate":e.rotateAxisAngle(g.x,g.y,g.z,g.angle);
break}return e};return b.fx});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric"],function(b){b.ui.xy.CSpinner=function(f){this.uId=b.getUId();this._domNode=null;b.mixin(this,f);if(this._validateProperties()!==false){this._initProperties();this._initDom()}};b.ui.xy.CSpinner.prototype={getDomNode:function(){return this._domNode},toggle:function(){this._timer?this._stopRendering():this._startRendering()},_startRendering:function(){if(!this._timer)this._timer=b.setInterval(this,"_render",this.refreshRate)},
_stopRendering:function(){clearInterval(this._timer);this._timer=null},_render:function(){this._ctx.clearRect(0,0,this.size,this.size);var f=this._ctx,h=this._cx,i=this._cy,j=this._r1,o=this._r2,k=this.count,n=this.space,l=this.linewidth,m=this._grdcolors,p=this.linecolor,q,s,r=(360-n*k)/k,t=0;q=0;for(s=k-this._position-1;q<k;q++){s=(s+1)%k;var u=f,x=h,A=i,D=j,B=o,w=t,v=t+r,C=l,z=m[s],E=p;u.beginPath();var y=d(x,A,D,w);u.moveTo(y.x,y.y);y=void 0;y=v>w?false:true;u.arc(x,A,D,c(w-90),c(v-90),y);y=d(x,
A,B,v);u.lineTo(y.x,y.y);y=void 0;y=w>v?false:true;u.arc(x,A,B,c(v-90),c(w-90),y);y=d(x,A,D,w);u.lineTo(y.x,y.y);u.closePath();d(x,A,D,w+Math.abs(v-w)/2);d(x,A,B,w+Math.abs(v-w)/2);u.fillStyle=z;u.fill();if(C>0){u.lineWidth=C;u.strokeStyle=E||"transparent";u.stroke()}t+=r+n}this._position=(this._position+1)%this.count},_validateProperties:function(){return true},_initDom:function(){var f=this._domNode=document.createElement("canvas");f.translate(0,0);this._ctx=f.getContext("2d");f.width=this.size;
f.height=this.size;this._render();this._startRendering()},_initProperties:function(){var f=this,h=function(i,j){if(f[i]!==0)f[i]=f[i]||j};h("size",25);h("fromcolor","#ccc");h("tocolor","#000");h("stopcolor",0.4);h("linecolor",null);h("radius",7);h("thickness",5);h("count",Math.floor(f.radius*1.5));h("space",10);h("linewidth",1);h("refreshRate",40);f._cx=f.size/2;f._cy=f.size/2;f._r1=f.radius;f._r2=f._r1+f.thickness;f._timer=null;f._grdcolors=g(f.fromcolor,f.tocolor,f.stopcolor,f.count);f._position=
0}};var a=b.math.round,c=b.math.degToRad,d=function(f,h,i,j){return{x:f+i*Math.cos(c(j-90)),y:h+i*Math.sin(c(j-90))}},g=function(f,h,i,j){f=e(f)||{r:0,g:0,b:0,a:1};h=e(h)||{r:255,g:255,b:255,a:1};var o=[],k,n,l=1,m=1/j,p=0;for(n=k=0;k<j;k++,n+=m){var q={r:f.r*l+(1-l)*h.r,g:f.g*l+(1-l)*h.g,b:f.b*l+(1-l)*h.b,a:f.a*l+(1-l)*h.a};o.push("rgba("+a(q.r,0)+","+a(q.g,0)+","+a(q.b,0)+","+a(q.a,2)+")");if(p==0&&n>=i)p=1/(j-k);l-=p;if(k==j-2)l=0}return o},e=function(f){var h=null,i=null;if(!h)if(h=/^#?([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})$/.exec(f)){for(i=
1;i<4;i++)h[i]=h[i].length==1?h[i]+h[i]:h[i];i={r:parseInt(h[1],16),g:parseInt(h[2],16),b:parseInt(h[3],16),a:1}}if(!h)if(h=/[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)?/.exec(f))i={r:h[1],g:h[2],b:h[3],a:h[4]||1};return i};return b.ui.xy.CSpinner});
define(["../../../_amd/core"],function(b){b.ux.MovementTracker=function(a){this.uId=b.getUId();this._properties=a;this._previousPoint=this._startPoint=this._pointStatement=this._target=null;this._tracking=false;this._acceptEvents=true;this._multitouch=false;this._params={captureFlow:true,preventStart:true,preventMove:false,shiftThreshold:0,trackThresholdX:0,trackThresholdY:0};if(this._validateProperties()!==false){this._initProperties();this._initListeners()}};b.ux.MovementTracker.prototype={updateTrackThresholdX:function(a){if(this._isValidThreshold(a))this._params.trackThresholdX=
a;else this._raisePropertyError("trackThresholdX")},updateTrackThresholdY:function(a){if(this._isValidThreshold(a))this._params.trackThresholdY=a;else this._raisePropertyError("trackThresholdY")},destroy:function(){this._removeListeners()},_validateProperties:function(){return true},_isValidThreshold:function(a){return b.isInteger(a)&&a>=0},_raisePropertyError:function(a){b.log("[MovementTracker] Error: "+a+" missing or invalid")},_initProperties:function(){this._target=$(this._properties.target);
if(this._properties.captureFlow===false)this._params.captureFlow=false;if(this._properties.preventStart===false)this._params.preventStart=false;if(this._properties.preventMove===true)this._params.preventMove=true;if(b.isSet(this._properties.trackThresholdX))this._params.trackThresholdX=this._properties.trackThresholdX;if(b.isSet(this._properties.trackThresholdY))this._params.trackThresholdY=this._properties.trackThresholdY;delete this._properties},_initListeners:function(){b.ux.touch.addListener(this._target,
"start",{context:this,method:"_handleTouchStart"},{preventDefault:this._params.preventStart,captureFlow:this._params.captureFlow});b.ux.touch.addListener(this._target,"move",{context:this,method:"_handleTouchMove"},{preventDefault:this._params.preventMove,captureFlow:this._params.captureFlow});b.ux.touch.addListener(this._target,"end",{context:this,method:"_handleTouchEnd"},{captureFlow:this._params.captureFlow})},_removeListeners:function(){b.ux.touch.removeListener(this._target,"start",{context:this,
method:"_handleTouchStart"});b.ux.touch.removeListener(this._target,"move",{context:this,method:"_handleTouchMove"});b.ux.touch.removeListener(this._target,"end",{context:this,method:"_handleTouchEnd"})},_handleTouchStart:function(a){if(b.ua.isAndroid)if(!this.defered){this.defered=true;if((new Date).getTime()-a.timestamp>100){this._acceptEvents=false;a.preventDefault();var c,d={exec:b.bind(function(){clearTimeout(c);this._acceptEvents=true;this._handleTouchStart(a)},this)};c=b.setTimeout(d,"exec",
0);return}}if(this._acceptEvents!=false){this._multitouch=false;if(a.multitouch==true)this._multitouch=true;else{this._acceptEvents=false;this._pointStatement=[];this._previousPoint=null;this._tracking=false;this._startPoint={x:a.x,y:a.y};d=this._onNewTouch(a);b.publish(d.name,d.params);this._acceptEvents=true}}},_handleTouchMove:function(a){if(this._acceptEvents!=false)if(!this._multitouch){this._acceptEvents=false;a=this._onNewTouch(a);b.publish(a.name,a.params);this._acceptEvents=true}},_handleTouchEnd:function(a){if(this._acceptEvents!=
false)if(!this._multitouch){this._acceptEvents=false;a=this._onNewTouch(a);b.publish(a.name,a.params);this._acceptEvents=true}},_onNewTouch:function(a){if(this._tracking==false)if(this._params.trackThresholdX==0||this._params.trackThresholdY==0)this._tracking=true;else{var c={x:a.x,y:a.y},d=Math.abs(c.x-this._startPoint.x);c=Math.abs(c.y-this._startPoint.y);if(d>this._params.trackThresholdX||c>this._params.trackThresholdY)this._tracking=true}d={name:"/movementtracker/events/notrack",params:{publisher:this,
uxEvent:a,target:this._target}};if(this._tracking==false)return d;if(this._pointStatement.length==0)d.name="/movementtracker/events/mvtbegin";else if(a.type=="move")d.name="/movementtracker/events/mvtchanged";else if(a.type=="end")d.name="/movementtracker/events/mvtstored";this._addTouch(a);d.params.movement=this._getCurrentMovement();return d},_addTouch:function(a){a={x:a.x,y:a.y,timestamp:a.timestamp};var c=0,d=0,g=0,e=0,f=0,h=0;if(this._previousPoint==null){a.duration=0;a.globalDuration=0;c=a.x;
d=a.y}else{c=this._previousPoint.x;d=this._previousPoint.y;g=this._previousPoint.globalDx;e=this._previousPoint.globalDy;f=this._previousPoint.directionX;h=this._previousPoint.directionY;a.duration=a.timestamp-this._previousPoint.timestamp;a.globalDuration=a.duration+this._previousPoint.globalDuration}a.dx=Math.abs(a.x-c);a.dy=Math.abs(a.y-d);a.globalDx=a.dx+g;a.globalDy=a.dy+e;a.directionX=f;a.directionY=h;if(f==0&&this._previousPoint!=null){if(a.x<c)a.directionX=-1;else if(a.x>c)a.directionX=1;
this._previousPoint.directionX=a.directionX}if(h==0&&this._previousPoint!=null){if(a.y<d)a.directionY=-1;else if(a.y>d)a.directionY=1;this._previousPoint.directionY=a.directionY}if(f>0&&a.x+this._params.shiftThreshold<c)a.directionX=-1;else if(f<0&&a.x-this._params.shiftThreshold>c)a.directionX=1;if(h>0&&a.y+this._params.shiftThreshold<d)a.directionY=-1;else if(h<0&&a.y-this._params.shiftThreshold>d)a.directionY=1;this._pointStatement.push(a);this._previousPoint=a},_getCurrentMovement:function(){var a=
this._pointStatement[this._pointStatement.length-1];return{pointStatement:this._pointStatement,duration:a.globalDuration,dx:a.globalDx,dy:a.globalDy}}};return b.ux.MovementTracker});
define(["../../../_amd/core","../../movementtracker/js/movementtracker"],function(b){b.ux.Inertia=function(a){this.uId=b.getUId();this._properties=a;this._movementtracker=null;if(this._validateProperties()!==false){this._initProperties();this._initListeners()}};b.ux.Inertia.prototype={_DIRECTION_X:"x",_DIRECTION_Y:"y",_INTERRUPTION_THRESHOLD:150,_EVENT_INERTIA_COMPUTED:"/inertia/events/inertiacomputed",destroy:function(){this._removeListeners()},_validateProperties:function(){return true},_initProperties:function(){this._movementtracker=
this._properties.movementtracker;delete this._properties},_initListeners:function(){b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_computeInertia"})},_removeListeners:function(){b.unsubscribe("/movementtracker/events/mvtstored",{context:this,method:"_computeInertia"})},_computeInertia:function(a){if(a.publisher.uId==this._movementtracker.uId){var c=a.movement,d={pointStatement:c.pointStatement},g=this._getSignificantMovement(c,this._DIRECTION_X);c=this._getSignificantMovement(c,
this._DIRECTION_Y);var e=g.pointStatement[0],f=c.pointStatement[0],h=g.pointStatement[g.pointStatement.length-1],i=c.pointStatement[c.pointStatement.length-1];d.dx=Math.abs(h.x-e.x);d.dy=Math.abs(i.y-f.y);d.dtx=h.globalDuration-e.globalDuration;if(d.dtx==0)d.dtx=1;d.dty=i.globalDuration-f.globalDuration;if(d.dty==0)d.dty=1;d.directionX=g.direction;d.directionY=c.direction;d.speedX=d.dx/d.dtx;d.speedY=d.dy/d.dty;b.publish(this._EVENT_INERTIA_COMPUTED,{publisher:this,movement:d,uxEvent:a.uxEvent,target:a.target})}},
_getSignificantMovement:function(a,c){var d=this._extractDirectedMovement(a,c);d=this._extractInterruptedMovement(d[d.length-1]);return d[d.length-1]},_extractDirectedMovement:function(a,c){var d=[],g=a.pointStatement,e=0,f=g[0].directionX;if(c==this._DIRECTION_Y)f=g[0].directionY;for(var h=0;h<g.length;h++){var i=g[h],j=i.directionX;if(c==this._DIRECTION_Y)j=i.directionY;if(f!=j||h==g.length-1){i=h;if(h==g.length-1)i=g.length;e={pointStatement:g.slice(e,i),direction:f};d.push(e);e=h;f=j}}return d},
_extractInterruptedMovement:function(a){for(var c=[],d=a.pointStatement,g=0,e=0,f=0;f<d.length;f++){e+=d[f].duration;var h=f;if(e>this._INTERRUPTION_THRESHOLD||f==d.length-1){if(f==d.length-1&&e<=this._INTERRUPTION_THRESHOLD)h=d.length;e=0;var i=d.slice(g,h);i={pointStatement:i,direction:a.direction};c.push(i);g=f;if(f==d.length-1&&e>this._INTERRUPTION_THRESHOLD){i=d.slice(h,h+1);i={pointStatement:i,direction:a.direction};c.push(i)}}}return c}};return b.ux.Inertia});
define(["../../../../_amd/core","../../../../ux/inertia/js/inertia"],function(b){b.ui.layout.Scroller=function(a){this.uId=b.getUId();this._direction=this._target=null;this._captureFlow=true;this._view={x:0,y:0,viewportSizeX:0,viewportSizeY:0,sizeX:0,sizeY:0,limitX:0,limitY:0,shiftOriginY:0,shiftLimitY:0,scrollbars:{x:null,y:null,active:true,width:null,backgroundColor:null,borderColor:null,opacityTransition:null},autoRefreshOptions:{active:false,checkDelay:1E3,handler:null},timerSize:null};this._scroll=
{canScrollX:false,canScrollY:false,mustScrollX:false,mustScrollY:false,friction:14,acceleration:-0.00126,minSpeed:0.05};this._transition={duration:0,delay:0,func:"cubic-bezier(0.1, 0.2, 0.5, 1)",endHandler:null};this._callbacks={scrollerTouched:null,scrollerClicked:null,startScrolling:null,scrolling:null,endScrolling:null,startSliding:null,stopSliding:null};this._inertia=this._movementtracker=null;this._activated=true;this._animated=this._moveOutside=false;this._selectionEvent=null;this._updateContext(a)};
b.ui.layout.Scroller.prototype={_DIRECTION_X:"x",_DIRECTION_Y:"y",_DIRECTION_XY:"xy",updateTargetSize:function(a,c,d){if(this._view.timerSize==null)if(d===true&&this._view.timerSize==null){this._refreshTargetSize(a,c,false);this._view.timerSize=b.setTimeout(this,"_refreshTargetSize",this._view.autoRefreshOptions.checkDelay,a,c,d)}else this._refreshTargetSize(a,c,d)},updateViewportSize:function(a,c){var d=this._target.parentNode.clientWidth,g=this._target.parentNode.clientHeight;if(b.isSet(a))d=a;
if(b.isSet(c))g=c;if(this._view.viewportSizeX!=d||this._view.viewportSizeY!=g){this._setViewportSize(d,g);this._refreshView()}},updateShiftBounds:function(a,c){var d=false;if(a!=this._view.shiftOriginY){this._view.shiftOriginY=a;if(this._view.y==0)this._view.y=a;d=true}if(c!=this._view.shiftLimitY){this._view.shiftLimitY=c;d=true}if(d){this._refreshView();this._backToBounds()}},autoRefresh:function(a){if(b.isSet(a.checkDelay)&&a.checkDelay>=0)this._view.autoRefreshOptions.checkDelay=a.checkDelay;
if(b.isSet(a.active)&&this._view.autoRefreshOptions.active!==a.active){this._view.autoRefreshOptions.active=a.active;this._listenToContentChanges(a.active)}},scrollTo:function(a,c,d){this._slideTo(a,c,{duration:d})},backToBounds:function(){this._backToBounds()},getPosition:function(){return{x:this._view.x,y:this._view.y}},getViewProperties:function(){return this._view},enable:function(){this._activated=true},disable:function(){this._activated=false},destroy:function(){this._removeListeners();this._movementtracker.destroy();
delete this._movementtracker;this._inertia.destroy();delete this._inertia;this._removeScrollbars(true,true);for(var a in this._callbacks)this._callbacks[a]=null;if(this._view.timerSize!=null){clearTimeout(this._view.timerSize);this._view.timerSize=null}b.fx.apply(this._target,{"user-select":""});b.fx.applyTransition(this._target,"","","","");b.fx.setTransform(this._target,"");this._target=null},changeContext:function(a){this.destroy();this._updateContext(a)},_setTargetSize:function(a,c){this._view.sizeX=
a;this._view.sizeY=c},_setViewportSize:function(a,c){this._view.viewportSizeX=a;this._view.viewportSizeY=c},_updateContext:function(a){this._properties=a;if(this._validateProperties()!==false){this._initProperties();this._initListeners();this._slideTo(0,0);this._refreshView()}},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Scroller] Error: "+a+" missing or invalid")},_initProperties:function(){this._target=$(this._properties.target);b.fx.apply(this._target,{"user-select":"none"});
if(b.isSet(this._properties.shiftOriginY))this._view.shiftOriginY=this._properties.shiftOriginY;if(b.isSet(this._properties.shiftLimitY))this._view.shiftLimitY=this._properties.shiftLimitY;this._setTargetSize(this._target.offsetWidth,this._target.offsetHeight);this._setViewportSize(this._target.parentNode.clientWidth,this._target.parentNode.clientHeight);this._direction=this._properties.direction;if(this._direction==this._DIRECTION_X||this._direction==this._DIRECTION_XY)this._scroll.mustScrollX=true;
if(this._direction==this._DIRECTION_Y||this._direction==this._DIRECTION_XY)this._scroll.mustScrollY=true;if(this._properties.captureFlow===false)this._captureFlow=false;if(b.isSet(this._properties.callbacks))for(var a in this._callbacks){var c=this._properties.callbacks[a];if(b.isSet(c))this._callbacks[a]=c}if(b.isSet(this._properties.scrollbars))for(a in this._view.scrollbars){c=this._properties.scrollbars[a];if(b.isSet(c))this._view.scrollbars[a]=c}a=this._properties.friction;if(b.isSet(a)&&b.isInteger(a)){this._scroll.friction=
Math.max(Math.min(a,100),1);this._scroll.acceleration=Math.min(-9.0E-5*this._scroll.friction,-1.0E-4);this._scroll.minSpeed=Math.sqrt(Math.abs(this._scroll.acceleration*2))}delete this._properties},_initListeners:function(){this._movementtracker=new b.ux.MovementTracker({target:this._target,captureFlow:this._captureFlow,preventStart:false,preventMove:false,trackThresholdX:5,trackThresholdY:5});b.subscribe("/movementtracker/events/notrack",{context:this,method:"_handleTouchNotTracked"});b.subscribe("/movementtracker/events/mvtbegin",
{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});this._inertia=new b.ux.Inertia({movementtracker:this._movementtracker});b.subscribe("/inertia/events/inertiaComputed",{context:this,method:"_handleMovementStored"});this._transition.endHandler=b.fx.onTransitionEnd(this._target,b.bind(this._handleTransitionEnd,this),true)},_removeListeners:function(){b.unsubscribe("/movementtracker/events/notrack",{context:this,
method:"_handleTouchNotTracked"});b.unsubscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.unsubscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});b.unsubscribe("/inertia/events/inertiaComputed",{context:this,method:"_handleMovementStored"});this._target.removeEventListener(b.has.prop("transitionend"),this._transition.endHandler,false);this._transition.endHandler=null;this._listenToContentChanges(false)},_listenToContentChanges:function(a){if(a){var c=
this._view.autoRefreshOptions.checkDelay>0;this._view.autoRefreshOptions.handler=b.bind(function(){var d=this._target.offsetHeight;if(this._view.sizeX!=this._target.offsetWidth||this._view.sizeY!=d)this.updateTargetSize(null,null,c)},this);this._target.addEventListener("DOMSubtreeModified",this._view.autoRefreshOptions.handler,false)}else if(this._view.autoRefreshOptions.handler!=null){this._target.removeEventListener("DOMSubtreeModified",this._view.autoRefreshOptions.handler,false);this._view.autoRefreshOptions.handler=
null}},_refreshTargetSize:function(a,c,d){this._view.timerSize!=null&&clearTimeout(this._view.timerSize);var g=this._target.offsetWidth,e=this._target.offsetHeight;if(b.isSet(a))g=a;if(b.isSet(c))e=c;this._view.timerSize=null;if(this._view.sizeX!=g||this._view.sizeY!=e){this._setTargetSize(g,e);this._refreshView();if(d===true)this._view.timerSize=b.setTimeout(this,"_refreshTargetSize",this._view.autoRefreshOptions.checkDelay,a,c,d)}},_refreshView:function(){var a=this._scroll.canScrollX,c=this._scroll.canScrollY;
if(this._view.sizeX>this._view.viewportSizeX){this._view.limitX=this._view.viewportSizeX-this._view.sizeX;this._scroll.canScrollX=true}else{this._view.limitX=0;this._scroll.canScrollX=false}shiftSizeY=this._view.sizeY-(this._view.shiftOriginY+this._view.shiftLimitY);if(shiftSizeY>this._view.viewportSizeY){this._view.limitY=this._view.viewportSizeY-shiftSizeY;this._scroll.canScrollY=true}else{this._view.limitY=0;this._scroll.canScrollY=false}this._scroll.canScrollX?this._movementtracker.updateTrackThresholdX(5):
this._movementtracker.updateTrackThresholdX(999);this._scroll.canScrollY?this._movementtracker.updateTrackThresholdY(5):this._movementtracker.updateTrackThresholdY(999);if(a!=this._scroll.canScrollX)if(this._view.x!=0){this._view.x=0;this._slideTo(null,null,{backToBound:true,duration:1})}if(c!=this._scroll.canScrollY)if(this._view.y!=0){this._view.y=0;this._slideTo(null,null,{backToBound:true,duration:1})}if(this._view.scrollbars.active==true){if(this._scroll.canScrollX&&this._scroll.mustScrollX){a=
this._view.scrollbars.x;if(a==null)a=this._view.scrollbars.x=new b.ui.layout.Scroller.Scrollbar({direction:"x",width:this._view.scrollbars.width,backgroundColor:this._view.scrollbars.backgroundColor,borderColor:this._view.scrollbars.borderColor,opacityTransition:this._view.scrollbars.opacityTransition});a.updateSize(this._view.viewportSizeX,this._view.sizeX);this._target.parentNode.appendChild(a.getDomNode())}else this._removeScrollbars(true,false);if(this._scroll.canScrollY&&this._scroll.mustScrollY){a=
this._view.scrollbars.y;if(a==null)a=this._view.scrollbars.y=new b.ui.layout.Scroller.Scrollbar({direction:"y",width:this._view.scrollbars.width,backgroundColor:this._view.scrollbars.backgroundColor,borderColor:this._view.scrollbars.borderColor,opacityTransition:this._view.scrollbars.opacityTransition});a.updateSize(this._view.viewportSizeY,shiftSizeY);this._target.parentNode.appendChild(a.getDomNode())}else this._removeScrollbars(false,true);a={timeout:null,hide:function(d){clearTimeout(this.timeout);
d._hideScrollbars()}};a.timeout=b.setTimeout(a,"hide",1E3,this)}},_removeScrollbars:function(a,c){if(a==true&&this._view.scrollbars.x!=null){this._target.parentNode.removeChild(this._view.scrollbars.x.getDomNode());this._view.scrollbars.x=null}if(c==true&&this._view.scrollbars.y!=null){this._target.parentNode.removeChild(this._view.scrollbars.y.getDomNode());this._view.scrollbars.y=null}},_handleTouchNotTracked:function(a){if(a.publisher.uId==this._movementtracker.uId){a=a.uxEvent;a.type=="start"&&
b.isSet(this._callbacks.scrollerTouched)&&b.call(this._callbacks.scrollerTouched,{uxEvent:a});if(this._activated!=false){a.preventDefault();a.stopPropagation();if(a.type=="start"){this._selectionEvent=null;if(this._animated==false)this._selectionEvent=a;a=this._getInstantPosition();if(!this._isAtPosition(a.x,a.y)){b.isSet(this._callbacks.stopSliding)&&b.call(this._callbacks.stopSliding,{});this._slideTo(a.x,a.y)}}else if(a.type=="end"){this._backToBounds();this._hideScrollbars();if(b.isSet(this._selectionEvent)){b.isSet(this._callbacks.scrollerClicked)&&
b.call(this._callbacks.scrollerClicked,{uxEvent:a});this._handleSelection(a)}}}}},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._activated!=false){a=a.uxEvent;a.preventDefault();a.stopPropagation();b.isSet(this._callbacks.startScrolling)&&b.call(this._callbacks.startScrolling,{uxEvent:a});b.isSet(this._view.autoRefreshOptions.handler)&&this._view.autoRefreshOptions.handler()}},_handleSelection:function(a){var c=this._getProperEventTarget(a);if(b.has("touch"))a.dispatch(c,
"click");else{a=c.tagName;if(b.isSet(a)&&(a.toLowerCase()=="textarea"||a.toLowerCase()=="input"&&c.type.toLowerCase()=="text"))c.focus()}},_getProperEventTarget:function(a){var c=a.target;if(a.target.nodeType==3)c=c.parentNode;return c},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._activated!=false){a.uxEvent.stopPropagation();var c=a.movement,d=c.pointStatement[c.pointStatement.length-2];c=c.pointStatement[c.pointStatement.length-1];var g=c.x-d.x;d=c.y-
d.y;var e=this._view.y;if(e>0)e-=this._view.shiftOriginY;else if(e<this._view.limitY)e+=this._view.shiftLimitY;this._moveOutside=false;e=this._getBoundsInfos(this._view.x,e);if(e.outsideOfBoundsX)if(e.directionX>0&&c.directionX>0||e.directionX<0&&c.directionX<0){g/=3;this._moveOutside=true}if(e.outsideOfBoundsY)if(e.directionY>0&&c.directionY>0||e.directionY<0&&c.directionY<0){d/=3;this._moveOutside=true}c=this._view.x+b.math.round(g,0);g=this._view.y+b.math.round(d,0);this._slideTo(c,g);b.isSet(this._callbacks.scrolling)&&
b.call(this._callbacks.scrolling,{uxEvent:a.uxEvent})}},_handleMovementStored:function(a){if(a.publisher.uId==this._inertia.uId)if(this._activated!=false){b.isSet(this._callbacks.endScrolling)&&b.call(this._callbacks.endScrolling,{uxEvent:a.uxEvent});a=a.movement;this._interpretInertia(a);if(!this._moveOutside&&!this._isAtPosition(a.destX,a.destY))this._slideTo(a.destX,a.destY,{duration:a.duration,speed:a.speed});else{this._backToBounds();this._hideScrollbars()}}},_interpretInertia:function(a){var c=
this._scroll.canScrollX&&this._scroll.mustScrollX,d=this._scroll.canScrollY&&this._scroll.mustScrollY,g=b.math.round(this._view.viewportSizeX/3,1),e=b.math.round(this._view.viewportSizeY/3,1),f=this._scroll.acceleration,h=this._scroll.minSpeed,i=a.speedX,j=a.speedY;i=i<h?0:i;j=j<h?0:j;h=-(i*i)/(2*f);var o=-(j*j)/(2*f),k=-i/f;f=-j/f;c||(h=k=0);d||(o=f=0);var n=this._getBoundsInfos(this._view.x+h*a.directionX,this._view.y+o*a.directionY);if(n.outsideOfBoundsX&&n.distanceToBoundX>g){g=n.distanceToBoundX-
g;var l=g/h;h-=g;k-=l*k}if(n.outsideOfBoundsY&&n.distanceToBoundY>e){g=n.distanceToBoundY-e;l=g/o;o-=g;f-=l*f}a.destX=this._view.x+b.math.round(h*a.directionX,0);a.destY=this._view.y+b.math.round(o*a.directionY,0);k=Math.max(b.math.round(k,0),1);f=Math.max(b.math.round(f,0),1);a.duration=f;a.speed=b.math.round(j,3);if(c&&!d||c&&d&&k>f){a.duration=k;a.speed=b.math.round(i,3)}},_handleTransitionEnd:function(){if(this._animated==true){this._animated=false;b.isSet(this._callbacks.stopSliding)&&b.call(this._callbacks.stopSliding,
{});var a=0;if(this._backToBounds())a=350;this._hideScrollbars(a)}},_backToBounds:function(){var a=this._getBoundsInfos(this._view.x,this._view.y);if(a.outsideOfBounds){var c=this._view.x,d=this._view.y;if(a.outsideOfBoundsX)c=a.positionOfBoundX;if(a.outsideOfBoundsY)d=a.positionOfBoundY;this._slideTo(c,d,{backToBound:true});return true}return false},_getBoundsInfos:function(a,c){var d={outsideOfBoundsX:false,outsideOfBoundsY:false,distanceToBoundX:0,distanceToBoundY:0};if(a>0||a<this._view.limitX){d.outsideOfBoundsX=
true;if(a>0){d.distanceToBoundX=Math.abs(a);d.directionX=1;d.positionOfBoundX=0}else{d.distanceToBoundX=Math.abs(a-this._view.limitX);d.directionX=-1;d.positionOfBoundX=this._view.limitX}}if(c>0||c<this._view.limitY){d.outsideOfBoundsY=true;if(c>0){d.distanceToBoundY=Math.abs(c);d.directionY=1;d.positionOfBoundY=0}else{d.distanceToBoundY=Math.abs(c-this._view.limitY);d.directionY=-1;d.positionOfBoundY=this._view.limitY}}d.outsideOfBounds=d.outsideOfBoundsX||d.outsideOfBoundsY;return d},_isAtPosition:function(a,
c){if(this._view.x==a&&this._view.y==c)return true;return false},_slideTo:function(a,c,d){var g=d&&d.duration?d.duration:0,e=d&&d.speed?d.speed:0;d=d&&d.backToBound?d.backToBound:false;this._transition.duration=g;if(g>=1){this._animated=true;b.isSet(this._callbacks.startSliding)&&b.call(this._callbacks.startSliding,{duration:g,speed:e})}else this._animated=false;g=g+"ms";e=this._transition.delay+"ms";var f=this._transition.func;if(d){g="350ms";f="cubic-bezier(0.3, 0.1, 1.0, 0.5)"}b.fx.applyTransformTransition(this._target,
g,e,f);if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.applyTransition(g,e,f);this._view.scrollbars.y!=null&&this._view.scrollbars.y.applyTransition(g,e,f)}this._translateTo(a,c)},_getInstantPosition:function(){var a=b.fx.getTransformPosition(this._target);a.y+=this._view.shiftOriginY;return a},_translateTo:function(a,c){var d=this._view.x,g=this._view.y;if(b.isSet(a)&&this._scroll.canScrollX&&this._scroll.mustScrollX)d=a;if(b.isSet(c)&&this._scroll.canScrollY&&
this._scroll.mustScrollY)g=c;this._view.x=parseInt(d);this._view.y=parseInt(g);this._target.translate(this._view.x,this._view.y-this._view.shiftOriginY);if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.updatePosition(this._view.x,this._view.y);this._view.scrollbars.y!=null&&this._view.scrollbars.y.updatePosition(this._view.x,this._view.y)}},_hideScrollbars:function(a){if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.hide(a);
this._view.scrollbars.y!=null&&this._view.scrollbars.y.hide(a)}}};b.ui.layout.Scroller.Scrollbar=function(a){this.uId=b.getUId();this._properties=a;this._direction=null;this._backgroundColor="rgba(0, 0, 0, 0.55)";this._borderColor="rgba(0, 0, 0, 0.2)";this._opacityTransition=true;this._view={x:0,y:0,viewportSize:0,contentSize:0,size:0,width:0,ratioSize:0,ratioPosition:0,ratioBounce:0,borderSize:1,availableSpace:0,showed:true};this._transition={duration:"",delay:"",func:""};this._ctx=this._canvasNode=
this._domNode=null;this._firstHide=true;if(this._validateProperties()!==false){this._initProperties();this._initDom()}};b.ui.layout.Scroller.Scrollbar.prototype={_DEFAULT_WIDTH:5,getDomNode:function(){return this._domNode},updateSize:function(a,c){var d=0,g=0;this._view.viewportSize=a-this._view.borderSize*2;this._view.contentSize=c;if(a<c){this._view.ratioSize=this._view.viewportSize/this._view.contentSize;this._view.ratioSize*=0.11*(this._view.contentSize/this._view.viewportSize)+0.89}else this._view.ratioSize=
1;d=g=this._view.ratioSize*this._view.viewportSize;if(this._direction=="y")d=this._view.width;else g=this._view.width;this._resize(d,g);this._view.availableSpace=this._view.viewportSize-this._view.size;this._view.ratioPosition=this._view.availableSpace/(this._view.contentSize-this._view.viewportSize);this._view.ratioBounce=0.0010*this._view.contentSize+3},updatePosition:function(a,c){this._view.showed==false&&this.show();var d=0,g=0,e=this._view.availableSpace;if(this._direction=="y"){g=-c*this._view.ratioPosition;
if(g<0||g>e)g=g<0?Math.max(g+g*this._view.ratioBounce,-this._view.size+5):Math.min(g+(g-e)*this._view.ratioBounce,this._view.viewportSize-5)}else{d=-a*this._view.ratioPosition;if(d<0||d>e)d=d<0?Math.max(d+d*this._view.ratioBounce,-this._view.size+5):Math.min(d+(d-e)*this._view.ratioBounce,this._view.viewportSize-5)}this._translateTo(d,g)},show:function(){if(this._view.showed!=true){this._view.showed=true;b.fx.applyTransition(this._canvasNode,"opacity","0ms","0ms","default");this._canvasNode.style.opacity=
1}},hide:function(a){if(this._view.showed!=false){this._view.showed=false;if(this._opacityTransition==true){var c=300;if(b.isSet(a))c+=a;if(this._firstHide){this._firstHide=false;c+=600}c+="ms";b.fx.applyTransition(this._canvasNode,"opacity","200ms",c,"default")}this._canvasNode.style.opacity=0}},applyTransition:function(a,c,d){var g=false;if(g=(g=(g=g||a!=this._transition.duration)||c!=this._transition.delay)||d!=this._transition.func){this._transition.duration=a;this._transition.delay=c;this._transition.func=
d;b.fx.applyTransformTransition(this._domNode,a,c,d)}},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Scrollbar] Error: "+a+" missing or invalid")},_initProperties:function(){this._direction=this._properties.direction;this._view.width=this._DEFAULT_WIDTH;if(b.isSet(this._properties.width))this._view.width=this._properties.width;if(b.isSet(this._properties.borderColor))this._borderColor=this._properties.borderColor;if(b.isSet(this._properties.backgroundColor))this._backgroundColor=
this._properties.backgroundColor;if(b.isSet(this._properties.opacityTransition))this._opacityTransition=this._properties.opacityTransition},_initDom:function(){var a=this._domNode=document.createElement("div"),c=this._canvasNode=document.createElement("canvas");this._ctx=c.getContext("2d");a.appendChild(c);var d={position:"absolute","pointer-events":"none",opacity:1};if(this._direction=="y"){d.top="0px";d.right="1px"}else{d.bottom="2px";d.left="0px"}b.fx.apply(a,d);b.fx.apply(c,{position:"absolute"});
c.translate(0,0)},_drawbar:function(){var a=this._direction=="y",c=this._ctx,d=a?this._view.width/2:this._view.width/2+1,g=a?this._view.width/2+1:this._view.width/2,e=a?this._view.width:this._view.size-1,f=a?this._view.size-1:this._view.width,h=a?e/2:f/2;c.fillStyle=this._backgroundColor;c.strokeStyle=this._borderColor;c.lineWidth=this._view.borderSize;c.beginPath();if(a){c.arc(d,g,h,Math.PI,0,false);c.lineTo(d+h,f-h);c.arc(d,f-h,h,0,Math.PI,false);c.lineTo(d-h,g)}else{c.arc(d,g,h,Math.PI/2,3*Math.PI/
2,false);c.lineTo(e-h,g-h);c.arc(e-h,g,h,3*Math.PI/2,Math.PI/2,false);c.lineTo(d,g+h)}c.closePath();c.fill();c.stroke()},_resize:function(a,c){this._view.size=this._direction=="y"?c:a;var d=this._canvasNode;this._ctx.clearRect(0,0,d.width,d.height);b.fx.apply(this._domNode,{width:a+1+"px",height:c+"px"});d.width=a;d.height=c;this._drawbar()},_translateTo:function(a,c){this._view.x=a;this._view.y=c;this._domNode.translate(a,c)}};return b.ui.layout.Scroller});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../ux/movementtracker/js/movementtracker"],function(b){b.ui.xyz.TagCloud=function(a){this.uId=b.getUId();this.selectedTextColor=this.textColor=this.size=null;this.scaleFactors={ratioDepth:0.6,ratioRating:0.8};this.canSelect=this.canMove=false;this.axis=null;this.shiftY=this.shiftX=0;this._isCircle=this._opacities=this._selection=this._selectCoords=this._overNode=this._domNode=this.tags=
this.asCircle=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xyz.TagCloud.prototype={_MAX_RATING:100,_Z_INDEX_BACKGROUND:5,_OPACITY_NOT_VISIBLE_FACE:0.2,_OPACITY_VISIBLE_FACE:0.98,_LIGHT_PI:b.math.round(Math.PI,3),_FRICTIONAL_FORCES:0.5,getDomNode:function(){return this._domNode},setTextColor:function(a,c){if(b.isSet(a))if(b.isSet(c)){this.textColor=a;this.selectedTextColor=c;this._updateTextColor()}},_validateProperties:function(){return true},
_raisePropertyError:function(a){b.log("[TagCloud] Error: "+a+" missing or invalid")},_initProperties:function(){this._isCircle=!b.isSet(this.asCircle)||!b.isSet(this.asCircle.tilt)?false:true;this._opacities=[];var a=this._OPACITY_NOT_VISIBLE_FACE,c=this.size*2+1,d=(this._OPACITY_VISIBLE_FACE-a)/(this.size*2),g=0;for(a=a;g<c;g++,a+=d)this._opacities[g]=b.math.round(a,2);c=this.tags.length;for(g=0;g<c;g++){d=this.tags[g];if(d.rating<0)d.rating=0;else if(d.rating>this._MAX_RATING)d.rating=this._MAX_RATING;
d.coeffRating=b.math.round(this.scaleFactors.ratioRating*(d.rating/this._MAX_RATING),2)}},_initDom:function(){this._domNode=document.createElement("div");this._overNode=document.createElement("div");this._domNode.appendChild(this._overNode);var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],g=document.createElement("div");this._domNode.appendChild(g);g.style.position="absolute";g.appendChild($(d.id));d.tagNode=g;d.colorOpacity=1}b.fx.apply(this._domNode,{position:"absolute",width:"100%",
height:"100%"});b.fx.apply(this._overNode,{position:"absolute",width:"100%",height:"100%","user-select":"none",zIndex:this._Z_INDEX_BACKGROUND});this._updateTextColor();this._initTransformations();this._slide(0.1,0.1)},_initListeners:function(){if(this.canMove==true||this.canSelect==true){this._movementtracker=new b.ux.MovementTracker({target:this._overNode});b.subscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",
{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"})}},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId){this._dragging=false;if(this.canSelect==true){a=a.movement.pointStatement[0];var c={x:this._overNode.getLeftPosition(),y:this._overNode.getTopPosition()};this._selectCoords={x:a.x-c.x,y:a.y-c.y}}}},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this.canMove==
true){a=a.movement;var c=a.pointStatement[a.pointStatement.length-2],d=a.pointStatement[a.pointStatement.length-1];a=d.x-c.x;c=d.y-c.y;d=b.math.getAngle(this.size,a);if(a<0)d=-d;a=b.math.getAngle(this.size,c);if(c<0)a=-a;this._dragging=true;this._slide(d,a)}},_handleMovementStored:function(a){a.publisher.uId==this._movementtracker.uId&&this._dragging==false&&this.canSelect==true&&this._handleChoice(this._selectCoords.x,this._selectCoords.y)},_slide:function(a,c){this._updateAngles(a,c);this._updateCoords();
this._updateOpacity();this._updateTextSize();this._applyTransformations()},_updateOpacity:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],g=b.math.round(d.coords.z+this.size,0),e=this._opacities[g];b.isSet(e)||b.log("[TagCloud] warn: opacity not defined for z-position "+g);d.colorOpacity=e}},_updateTextSize:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],g=b.math.round(d.coords.z+this.size,0);d.coeffDepth=b.math.round(this.scaleFactors.ratioDepth*(g/
(this.size*2)),2);d.coeffScale=d.coeffDepth+d.coeffRating}},_updateAngles:function(a,c){this._angleX=b.math.round(a*this._FRICTIONAL_FORCES%(this._LIGHT_PI*2),3);this._angleY=b.math.round(c*this._FRICTIONAL_FORCES%(this._LIGHT_PI*2),3)},_updateCoords:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],g=[d.coords.x,d.coords.y,d.coords.z],e=b.math.createTransformMatrix();if(this.axis=="x"||this.axis=="xy")e.rotateAxisAngle(1,0,0,b.math.radToDeg(this._angleY));var f=b.math.createTransformMatrix();
if(this.axis=="y"||this.axis=="xy")f.rotateAxisAngle(0,1,0,b.math.radToDeg(-this._angleX));g=b.math.multiplyMatrixVector(e.getValues(),g);f=b.math.multiplyMatrixVector(f.getValues(),g);g=f[0];e=f[1];var h=f[2];if(this._isCircle)if(this.axis=="x")g=f[2]*-this.asCircle.tilt;else e=f[2]*this.asCircle.tilt;d.coords={x:g,y:e,z:h}}},_applyTransformations:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a];b.fx.setTransformPart(d.tagNode,1,{type:"scale",x:d.coeffScale,y:d.coeffScale,
z:1});b.fx.setTransformPart(d.tagNode,2,{type:"translate",x:d.coords.x,y:d.coords.y,z:d.coords.z});b.fx.applyComposedTransform(d.tagNode)}this._updateTextColor()},_handleChoice:function(a,c){this._selection=null;var d=this._getNearestFaceIndex(a,c);if(d!=null){this._selection=this.tags[d].tagNode;d=this.tags[d];this._updateTextColor();b.publish("/tagcloud/events/selection",{tag:d})}},_getNearestFaceIndex:function(a,c){var d=null,g=[],e,f=this.tags.length;for(e=0;e<f;e++){var h=this.tags[e],i=h.tagNode.offsetWidth,
j=h.tagNode.offsetHeight,o=i*h.coeffScale-i,k=j*h.coeffScale-j,n=h.coords.x+this.size+this.shiftX-o/2;h=h.coords.y+this.size+this.shiftY-k/2;i=n+i+o;j=h+j+k;j=c>h&&c<j;a>n&&a<i&&j&&g.push(e)}f=-this.size;for(e=0;e<g.length;e++){n=g[e];j=this.tags[n].coords.z;if(j>f){f=j;d=n}}return d},_initTransformations:function(){for(var a=this.size,c=b.math.round(this._LIGHT_PI*(3-Math.sqrt(5)),2),d=2/this.tags.length,g=2*Math.PI/this.tags.length,e=this.tags.length,f=0,h=0,i=1-d/2;f<e;f++,h+=c,i-=d){var j=this.tags[f];
if(this._isCircle){var o=0,k=0;if(this.axis=="x"){o=g*f;k=Math.PI/2}else o=g*f+Math.PI/2;j.coords={x:a*Math.cos(k)*Math.cos(o),y:a*Math.cos(o)*Math.sin(k),z:a*Math.sin(o)}}else{o=a*Math.sqrt(1-i*i);j.coords={x:Math.cos(h)*o,y:Math.sin(h)*o,z:i*a}}b.fx.initComposedTransform(j.tagNode)}b.fx.set3dTransform(this._domNode,{type:"translate",x:this.size+this.shiftX,y:this.size+this.shiftY,z:0});b.fx.set3dTransform(this._overNode,{type:"translate",x:-this.size-this.shiftX,y:-this.size-this.shiftY,z:this.size})},
_updateTextColor:function(){if(b.isSet(this.textColor)){var a=this.textColor,c,d=this.tags.length;for(c=0;c<d;c++){var g=this.tags[c];g.tagNode.style.color="rgba("+a.r+", "+a.g+", "+a.b+", "+g.colorOpacity+")"}}if(this._selection!=null&&b.isSet(this.selectedTextColor)){a=this.selectedTextColor;this._selection.style.color="rgba("+a.r+", "+a.g+", "+a.b+", 1)"}}};return b.ui.xyz.TagCloud});
define(["../../../../_amd/core"],function(b){b.ui.xy.ToggleButton=function(a){this.uId=b.getUId();this._switchBtnNode=this._domNode=this.position=this.cssClass=null;this._coordinates={beginX:0,pozX:0,dist:0,hasMoved:false};b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xy.ToggleButton.prototype={_POSITION_LEFT:"left",_POSITION_RIGHT:"right",_LEFT:1,_RIGHT:0,getDomNode:function(){return this._domNode},_validateProperties:function(){return true},
_initProperties:function(){this.position=b.isSet(this.position)?this.position==this._POSITION_LEFT?this._LEFT:this._RIGHT:this._LEFT},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="to_toggle";b.isSet(this.cssClass)&&b.addClass(this._domNode,this.cssClass);this._switchBtnNode=document.createElement("div");this._switchBtnNode.className="to_toggle_btn";this._domNode.appendChild(this._switchBtnNode);this._translateButton((0-this.position)*44)},_initListeners:function(){b.ux.touch.addListener(this._switchBtnNode,
"start",{context:this,method:"_startdrag"},{preventDefault:true});b.ux.touch.addListener(this._switchBtnNode,"move",{context:this,method:"_drag"},{preventDefault:true});b.ux.touch.addListener(this._switchBtnNode,"end",{context:this,method:"_enddrag"},{preventDefault:true})},_translateButton:function(a){this._switchBtnNode.translate(a,0)},_onSwitch:function(){this.position=1-this.position;b.fx.applyTransformTransition(this._switchBtnNode,"500ms","0ms","default");this._translateButton((0-this.position)*
44);this.position==this._LEFT?b.publish("/togglebutton/events/switch",{uId:this.uId,position:this._POSITION_LEFT}):b.publish("/togglebutton/events/switch",{uId:this.uId,position:this._POSITION_RIGHT})},_startdrag:function(a){this._coordinates.beginX=a.x;this._coordinates.pozX=a.x;this._coordinates.dist=0;this._coordinates.hasMoved=false;b.fx.applyTransformTransition(this._switchBtnNode,"0s","0s","default")},_drag:function(a){this._coordinates.hasMoved=true;this._coordinates.pozX=a.x;a=this._coordinates.pozX-
this._coordinates.beginX;if(this.position==this._RIGHT&&a>0||this.position==this._LEFT&&a<0)a=0;if(this.position==this._RIGHT&&a<=0&&a>=-44||this.position==this._LEFT&&a>=0&&a<=44){if(this.position==this._LEFT)a-=44;this._coordinates.dist=a;this._translateButton(this._coordinates.dist)}},_enddrag:function(){if(this._coordinates.hasMoved==false||this.position==this._RIGHT&&this._coordinates.dist!=0||this.position==this._LEFT&&this._coordinates.dist!=-44)this._onSwitch();this._coordinates.dist=0;this._coordinates.beginX=
0;this._coordinates.pozX=0;this._coordinates.hasMoved=false}};return b.ui.xy.ToggleButton});
define(["../../../../_amd/core"],function(b){b.ui.layout.SlidingPanels=function(a){this.uId=b.getUId();this.pages=null;this.transitionType="default";this.duration=800;this.HIGHER_INDEX=100;this.LOWER_INDEX=99;this._domNode=null;this._queue=[];this._pagesList=[];this._currentPage=this._firstPage=null;this._isSliding=false;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initProperties()}};b.ui.layout.SlidingPanels.prototype={_TRANSITION_DEFAULT:"default",_TRANSITION_REVEAL:"reveal",
_TRANSITION_COVER:"cover",getDomNode:function(){return this._domNode},slideTo:function(a){if(!this._isSliding){var c=this._getQueueIndex(a);if(c!==false)c==this._queue.length-1?this.slideBack():this._silentSlideBack(a);else{c=this._firstPage;a=this._getPageById(a);var d=this.transitionType,g=this.duration,e=d==this._TRANSITION_REVEAL;d=d==this._TRANSITION_COVER;if(a!=null)this._slideStart({firstPage:c,currentPage:a,firstPageDuration:d?"":g,currentPageDuration:e?"":g,pageToListen:e?c:a,slideEndHandler:b.bind(this._onSlideEnd,
this,-1),firstPageTranslation:d?0:"-100%",firstPageZIndex:d?this.LOWER_INDEX:undefined,currentPageZIndex:d?this.HIGHER_INDEX:undefined})}}},slideBack:function(){if(!this._isSliding){var a=this._firstPage,c=this._queue.pop(),d=this.transitionType,g=this.duration,e=d==this._TRANSITION_REVEAL;this._slideStart({firstPage:a,currentPage:c,firstPageDuration:e?"":g,currentPageDuration:d==this._TRANSITION_COVER?"":g,pageToListen:e?c:a,slideEndHandler:b.bind(this._onSlideEnd,this,1),firstPageTranslation:e?
0:"100%",firstPageZIndex:e?this.LOWER_INDEX:undefined,currentPageZIndex:e?this.HIGHER_INDEX:undefined})}},_silentSlideBack:function(a){var c=this._getQueueIndex(a);a=this._queue.slice(c+1,this._queue.length);this._queue.splice(c+1,a.length);var d=a.length;for(c=0;c<d;c++){var g=a[c];g.setTranslateDuration(0);g.translate("100%");g.setPosition(1);this.transitionType!=this._TRANSITION_DEFAULT&&g.setZIndex(this.LOWER_INDEX)}this._firstPage=this._currentPage;this.slideBack()},_slideStart:function(a){this._isSliding=
true;b.publish("/slidingpanels/events/slidestart",{id:a.currentPage.id});this._currentPage=a.currentPage;a.firstPageZIndex&&a.firstPage.setZIndex(this.LOWER_INDEX);a.currentPageZIndex&&a.currentPage.setZIndex(this.HIGHER_INDEX);a.currentPage.display();a.firstPage.setTranslateDuration(a.firstPageDuration);a.currentPage.setTranslateDuration(a.currentPageDuration);b.fx.onTransitionEnd(a.pageToListen.getDomNode(),a.slideEndHandler);a.firstPage.translate(a.firstPageTranslation,0);a.currentPage.translate(0)},
_onSlideEnd:function(a){var c=this._firstPage,d=this._currentPage;if(this.transitionType!=this._TRANSITION_DEFAULT){c.setZIndex(this.LOWER_INDEX);d.setZIndex(this.HIGHER_INDEX)}c.setPosition(a);d.setPosition(0);a==-1&&this._queue.push(c);this._firstPage=this._currentPage;this._isSliding=false;b.publish("/slidingpanels/events/slideend",{id:d.id})},_getPageById:function(a){var c,d=this._pagesList,g=d.length;for(c=0;c<g;c++){var e=d[c];if(e.id==a&&e.position==1)return e}return null},_getQueueIndex:function(a){var c,
d=this._queue,g=d.length;for(c=0;c<g;c++)if(d[c].id==a)return c;return false},_validateProperties:function(){return true},_initProperties:function(){var a=this.transitionType,c,d=this.pages,g=d.length;for(c=0;c<g;c++){var e=new b.ui.layout.SlidingPanels.Page({node:$(d[c])});if(c==0){e.translate(0);e.setPosition(0);this._firstPage=e}else{var f="100%";if(a==this._TRANSITION_REVEAL)f=0;e.translate(f);e.setPosition(1)}if(a!=this._TRANSITION_DEFAULT)c==0?e.setZIndex(this.HIGHER_INDEX):e.setZIndex(this.LOWER_INDEX);
f=e.getDomNode();f.parentNode.removeChild(f);this._domNode.appendChild(f);this._pagesList.push(e)}if(b.isInteger(this.duration))this.duration+="ms"},_initDom:function(){this._domNode=document.createElement("div");b.addClass(this._domNode,"sl_container")}};b.ui.layout.SlidingPanels.Page=function(a){this.uId=b.getUId();this.id=null;this.position=0;this._properties=a;this._domNode=null;this._toDefer=this._isDisplayed=false;this._initProperties();this._initDom()};b.ui.layout.SlidingPanels.Page.prototype=
{wkArOldIOS:b.ua.isIOS&&b.ua.osVersion<=2,getDomNode:function(){return this._domNode},setPosition:function(a){this.position=a;if(this.position!=0){if(!this.wkArOldIOS){this._domNode.style.display="none";this._isDisplayed=false}}else b.fx.apply(this._domNode,{transform:"none"})},display:function(){this._domNode.style.display="block";if(this._isDisplayed==false)this._toDefer=this._isDisplayed=true},translate:function(a){var c,d={defered:b.bind(function(){c&&clearTimeout(c);this._domNode.translate(a,
null)},this)};if(this._toDefer){c=b.setTimeout(d,"defered",0);this._toDefer=false}else d.defered()},setZIndex:function(a){this._domNode.style.zIndex=a},setTranslateDuration:function(a){b.fx.applyTransformTransition(this._domNode,a,"1ms","default")},_initDom:function(){b.addClass(this._domNode,"sl_page")},_initProperties:function(){this._domNode=this._properties.node;this.id=this._domNode.id}};return b.ui.layout.SlidingPanels});
define(["../../../../_amd/core"],function(b){b.ui.xy.ColorPicker=function(){if(b.isUndefined(b.ui.xy.ColorPicker.singleton)){this.uId=1;this._HEIGHT=276;this._WIDTH=230;this._template="";this._domNode=null;this._colors=["#000","#9F3F0F","#0F3F0F","#0F3F6F","#0E0E85","#3F4F3F","#870F0F","#87870F","#0F870F","#0F8787","#0F0FFF","#6F6F9F","#FF0000","#FF9F0F","#9FC000","#3FCFCF","#3F6FFF","#9F9F9F","#FF0FFF","#FFCF0F","#FFFF00","#0FFF0F","#0FFFFF","#0FCFFF","#9F3F6F","#FF9FCF","#FFCF9F","#FFFF9F","#CF9FFF",
"#FFF"];this._createTemplate();this._initDom();b.ui.xy.ColorPicker.singleton=this}else return b.ui.xy.ColorPicker.singleton};b.ui.xy.ColorPicker.prototype={show:function(){b.layer.show();b.fx.apply(this._domNode,{display:"block"});this.updatePosition()},hide:function(){b.layer.hide();this._domNode.style.display="none"},updatePosition:function(){b.fx.apply(this._domNode,{top:window.innerHeight>this._HEIGHT?(window.innerHeight-this._HEIGHT)/2+window.scrollY+"px":window.scrollY+"px",left:document.documentElement.offsetWidth>
this._WIDTH?(document.documentElement.offsetWidth-this._WIDTH)/2+window.scrollX+"px":window.scrollX+"px"})},_createTemplate:function(){var a=0,c=this._colors.length;this._template+='<div><div class="w_icon w_float w_button_close" onClick="(new wink.ui.xy.ColorPicker()).hide()"></div>';for(var d=0;d<c;d++){if(a==0)this._template+='<div class="cp_separator">';this._template+='<div class="cp_color" style="background-color: '+this._colors[d]+'" onClick="(new wink.ui.xy.ColorPicker())._selectColor(\''+
this._colors[d]+"')\"></div>";if(a==4){this._template+="</div>";a=0}else a++}this._template+="</div>"},_selectColor:function(a){b.publish("/colorpicker/events/pickcolor",{color:a});this.hide()},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_bloc w_window cp_colorpicker w_border w_radius w_bg_dark";this._domNode.style.display="none";this._domNode.innerHTML=this._template;document.body.appendChild(this._domNode)}};return b.ui.xy.ColorPicker});
